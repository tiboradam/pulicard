
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Administration Manual &#8212; UNICEF INVENT - documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Installation Manual" href="installation_manual.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="tex2jax_ignore mathjax_ignore section" id="administration-manual">
<h1>Administration Manual<a class="headerlink" href="#administration-manual" title="Permalink to this headline">¶</a></h1>
<div class="section" id="translations">
<h2>Translations<a class="headerlink" href="#translations" title="Permalink to this headline">¶</a></h2>
<p>The interface to run and configure translations is loaded in http://localhost/translate. Backend uses Rosetta Django application that eases the translation process in django projects and can be configured via parameters defined in <code class="docutils literal notranslate"><span class="pre">django/tiip/settings.py</span></code> file (see <a class="reference external" href="https://django-rosetta.readthedocs.io/settings.html">rosetta-settings</a>
When logging for the first time the following page will appear when filtered by <strong>PROJEC</strong>T:</p>
<div class="figure align-default" id="translations1">
<a class="bg-primary mb-1 reference internal image-reference" href="_images/translations1.png"><img alt="system-context-diagram" class="bg-primary mb-1" src="_images/translations1.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><strong>STranslations - Rosetta Screen (no translations loaded)</strong></span><a class="headerlink" href="#translations1" title="Permalink to this image">¶</a></p>
</div>
<p>The languages currently supported by the project and will be referenced as LANG below are the following:</p>
<ul class="simple">
<li><p>en: English</p></li>
<li><p>fr: French</p></li>
<li><p>es: Spanish</p></li>
<li><p>pt: Portuguese</p></li>
<li><p>ar: Arabic</p></li>
</ul>
<p>To manually update translations for frontend run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose <span class="nb">exec</span> django python manage.py update_translations master.pot
</pre></div>
</div>
<p>Message files (<code class="docutils literal notranslate"><span class="pre">djangojs.po</span></code>) will be generated under <code class="docutils literal notranslate"><span class="pre">/translations/LANG/LC_MESSAGES</span></code> which handles translations for full frontend as shown in the screenshot below:</p>
<div class="figure align-default" id="translations2">
<a class="bg-primary mb-1 reference internal image-reference" href="_images/translations2.png"><img alt="system-context-diagram" class="bg-primary mb-1" src="_images/translations2.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><strong>Translations - Rosetta Screen (frontend translations loaded)</strong></span><a class="headerlink" href="#translations2" title="Permalink to this image">¶</a></p>
</div>
<p>In order to update translations for backend static data execute the following command to create message files(<code class="docutils literal notranslate"><span class="pre">django.po</span></code>) for each new language. For example, for Engish language:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose <span class="nb">exec</span> django django-admin makemessages -l en 
</pre></div>
</div>
<p>The makemessages script runs over the application source tree and pulls out all strings marked for translation. It creates (or updates) a message file in the directory <code class="docutils literal notranslate"><span class="pre">locale/LANG/LC_MESSAGES</span></code>. In the example above, the file will be <code class="docutils literal notranslate"><span class="pre">locale/en/LC_MESSAGES/django.po</span></code>.</p>
<p>Execute the same command for other supported languages:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose <span class="nb">exec</span> django django-admin makemessages -l fr
docker-compose <span class="nb">exec</span> django django-admin makemessages -l es
docker-compose <span class="nb">exec</span> django django-admin makemessages -l pt
docker-compose <span class="nb">exec</span> django django-admin makemessages -l ar
</pre></div>
</div>
<p>Then compile the message files created above by executing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose <span class="nb">exec</span> django django-admin compilemessages
</pre></div>
</div>
<p>Finally, the Project Translation page will have the following items and the translations are ready to use.</p>
<div class="figure align-default" id="translations3">
<a class="bg-primary mb-1 reference internal image-reference" href="_images/translations3.png"><img alt="system-context-diagram" class="bg-primary mb-1" src="_images/translations3.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><strong>Translations - Rosetta Screen (backend translations loaded)</strong></span><a class="headerlink" href="#translations3" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="user-management">
<h2>User Management<a class="headerlink" href="#user-management" title="Permalink to this headline">¶</a></h2>
<p>This section contains instructions how a superuser can create / modify / delete users and super users.</p>
<div class="section" id="ser-creation">
<h3>ser creation<a class="headerlink" href="#ser-creation" title="Permalink to this headline">¶</a></h3>
<p>A superuser has to login to http://localhost/admin
Under AUTHENTICATION AND AUTHORIZATION tab click on “Users” and the on the right corner clicks on “Add user”. Alternatively, click on “Add” icon next to “Users”.
Fill in the requested fields username/password and in the “USER PROFILES” add UNICEF as Donor and add user’s organization.
Finalize by clicking “SAVE”.
When the user tries to login it will fail because the organization has not been created.
In order to create the organization, execute the following and provide the UNICEF Organization to the invoked shell:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose <span class="nb">exec</span> django python manage.py shell


from user.models import Organisation
Organisation.objects.create<span class="o">(</span><span class="nv">name</span><span class="o">=</span>’UNICEF’<span class="o">)</span>
</pre></div>
</div>
<p>Then restart django backend:</p>
<ul class="simple">
<li><p>Stop the running process by typing <code class="docutils literal notranslate"><span class="pre">CTRL+C</span></code></p></li>
<li><p>Run the command <code class="docutils literal notranslate"><span class="pre">docker-compose</span> <span class="pre">up</span></code> to apply the above change</p></li>
</ul>
</div>
<div class="section" id="user-modification">
<h3>User modification<a class="headerlink" href="#user-modification" title="Permalink to this headline">¶</a></h3>
<p>Modify a user by clicking on the user’s related USER PROFILE checkbox. Apply the necessary changes and click on SAVE.</p>
</div>
<div class="section" id="user-deletion">
<h3>User deletion<a class="headerlink" href="#user-deletion" title="Permalink to this headline">¶</a></h3>
<p>Delete a user by clicking on the user’s related USER PROFILE checkbox. Then select from the “Action’ drop-down menu “Delete selected users”. Alternatively, enter the user’s information as before and click on “DELETE” red button. A redirection page appears to confirm the deletion.</p>
</div>
</div>
<div class="section" id="emails">
<h2>Emails<a class="headerlink" href="#emails" title="Permalink to this headline">¶</a></h2>
<p>Emails are sent to notify users or superusers in order to take some actions on pending issues  or inform them about new requests. The email templates along with the corresponding task are the following:</p>
<ul class="simple">
<li><p>send_project_approval_digest</p></li>
</ul>
<div class="figure align-default" id="send-project-approval-digest">
<a class="bg-primary mb-1 reference internal image-reference" href="_images/emails_send_project_approval_digest.png"><img alt="email_send_project_approval_digest" class="bg-primary mb-1" src="_images/emails_send_project_approval_digest.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><strong>Email send_project_approval_digest</strong></span><a class="headerlink" href="#send-project-approval-digest" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>project_still_in_draft_notification</p></li>
</ul>
<div class="figure align-default" id="project-still-in-draft-notification">
<a class="bg-primary mb-1 reference internal image-reference" href="_images/emails_project_still_in_draft_notification.png"><img alt="project_still_in_draft_notification" class="bg-primary mb-1" src="_images/emails_project_still_in_draft_notification.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><strong>Email project_still_in_draft_notification</strong></span><a class="headerlink" href="#project-still-in-draft-notification" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>published_projects_updated_long_ago</p></li>
</ul>
<div class="figure align-default" id="published-projects-updated-long-ago">
<a class="bg-primary mb-1 reference internal image-reference" href="_images/emails_published_projects_updated_long_ago.png"><img alt="emails_published_projects_updated_long_ago" class="bg-primary mb-1" src="_images/emails_published_projects_updated_long_ago.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><strong>Email published_projects_updated_long_ago</strong></span><a class="headerlink" href="#published-projects-updated-long-ago" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>project_review_requested_monthly_notification</p></li>
</ul>
<div class="figure align-default" id="project-review-requested-monthly-notification">
<a class="bg-primary mb-1 reference internal image-reference" href="_images/emails_project_review_requested_monthly_notification.png"><img alt="emails_project_review_requested_monthly_notification" class="bg-primary mb-1" src="_images/emails_project_review_requested_monthly_notification.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><strong>Email project_review_requested_monthly_notification</strong></span><a class="headerlink" href="#project-review-requested-monthly-notification" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>project_review_requested_on_create_notification</p></li>
</ul>
<div class="figure align-default" id="project-review-requested-on-create-notification">
<a class="bg-primary mb-1 reference internal image-reference" href="_images/emails_project_review_requested_on_create_notification.png"><img alt="emails_project_review_requested_on_create_notification" class="bg-primary mb-1" src="_images/emails_project_review_requested_on_create_notification.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><strong>Email project_review_requested_on_create_notification</strong></span><a class="headerlink" href="#project-review-requested-on-create-notification" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>notify_superusers_about_new_pending_approval</p></li>
</ul>
<div class="figure align-default" id="notify-superusers-about-new-pending-approval">
<a class="bg-primary mb-1 reference internal image-reference" href="_images/email_notify_superusers_about_new_pending_approval.png"><img alt="emails_notify_superusers_about_new_pending_approval" class="bg-primary mb-1" src="_images/email_notify_superusers_about_new_pending_approval.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><strong>Email notify_superusers_about_new_pending_approval</strong></span><a class="headerlink" href="#notify-superusers-about-new-pending-approval" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>notify_user_about_approval</p></li>
</ul>
<div class="figure align-default" id="notify-user-about-approval">
<a class="bg-primary mb-1 reference internal image-reference" href="_images/emails_notify_user_about_approval.png"><img alt="emails_notify_user_about_approval" class="bg-primary mb-1" src="_images/emails_notify_user_about_approval.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><strong>Email notify_user_about_approval</strong></span><a class="headerlink" href="#notify-user-about-approval" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>send_user_request_to_admins</p></li>
</ul>
<div class="figure align-default" id="send-user-request-to-admins">
<a class="bg-primary mb-1 reference internal image-reference" href="_images/emails_send_user_request_to_admins.png"><img alt="emails_send_user_request_to_admins" class="bg-primary mb-1" src="_images/emails_send_user_request_to_admins.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><strong>Email send_user_request_to_admins</strong></span><a class="headerlink" href="#send-user-request-to-admins" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="scheduled-tasks">
<h2>Scheduled Tasks<a class="headerlink" href="#scheduled-tasks" title="Permalink to this headline">¶</a></h2>
<p>There are some scheduled tasks configured in the application regarding actions where notification mails should be sent. These tasks are defined under <code class="docutils literal notranslate"><span class="pre">django/project/tasks.py</span></code>:</p>
<table class="docutils align-default" id="docker-images-table">
<caption><span class="caption-text">Docker Images</span><a class="headerlink" href="#docker-images-table" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Task Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>How it is triggered</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>project_review_requested_on_create_notification</p></td>
<td><p>New project review request</p></td>
<td><p>When portfolio admins make a new review initiation</p></td>
</tr>
<tr class="row-odd"><td><p>project_review_requested_monthly_notification</p></td>
<td><p>Sent to users who have incomplete reviews</p></td>
<td><p>scheduled to run every 30 days</p></td>
</tr>
<tr class="row-even"><td><p>project_still_in_draft_notification</p></td>
<td><p>One or more of user’s projects have not been published yet</p></td>
<td><p>scheduled to run every 31 days</p></td>
</tr>
<tr class="row-odd"><td><p>published_projects_updated_long_ago</p></td>
<td><p>One or more of user’s projects have not been updated for 6 months</p></td>
<td><p>scheduled to run every 31 days</p></td>
</tr>
<tr class="row-even"><td><p>send_project_approval_digest</p></td>
<td><p>Action required: New projects awaiting approval</p></td>
<td><p>scheduled to run everyday</p></td>
</tr>
<tr class="row-odd"><td><p>notify_superusers_about_new_pending_approval</p></td>
<td><p>Sent to superusers</p></td>
<td><p>When new software/hardware/nontech/platform function is added in the “Other” request</p></td>
</tr>
<tr class="row-even"><td><p>notify_user_about_approval</p></td>
<td><p>Sent to user who requested such object</p></td>
<td><p>When admin declines a newly requested software/hardware/nontech/platform function by the user</p></td>
</tr>
</tbody>
</table>
<p>and <code class="docutils literal notranslate"><span class="pre">django/user/tasks.py</span></code>:</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Docker Images</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Task Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>How it is triggered</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>send_user_request_to_admins</p></td>
<td><p>Sent to user who requested a special role on signup</p></td>
<td><p>When user signs up for the first time and chooses a special role (chooser disabled currently on Invent)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="load-taxonomies">
<h2>Load Taxonomies<a class="headerlink" href="#load-taxonomies" title="Permalink to this headline">¶</a></h2>
<p>Taxonomies are loaded automatically when executing the migration during the backend deployment phase 6.6.2 and can be viewed in administration page.</p>
<div class="figure align-default" id="taxonomies-loaded">
<a class="bg-primary mb-1 reference internal image-reference" href="_images/taxonomies_loaded.png"><img alt="taxonomies_loaded" class="bg-primary mb-1" src="_images/taxonomies_loaded.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">** Taxonomies Load Screen**</span><a class="headerlink" href="#taxonomies-loaded" title="Permalink to this image">¶</a></p>
</div>
<p>When selecting to see for example the available options for UNICEF Sectors the following list appears</p>
<div class="figure align-default" id="taxonomies-loaded2">
<a class="bg-primary mb-1 reference internal image-reference" href="_images/taxonomies_loaded2.png"><img alt="taxonomies_loaded2" class="bg-primary mb-1" src="_images/taxonomies_loaded2.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">** Taxonomies Load Screen**</span><a class="headerlink" href="#taxonomies-loaded2" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="rebuilding-search">
<h2>Rebuilding search<a class="headerlink" href="#rebuilding-search" title="Permalink to this headline">¶</a></h2>
<p>Rebuild search should be executed when the data related to project application are modified from command line in order to reflect the changes in search engine. To execute rebuild search management command run the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose <span class="nb">exec</span> django python manage.py rebuild_search
</pre></div>
</div>
</div>
<div class="section" id="enable-logging">
<h2>Enable logging<a class="headerlink" href="#enable-logging" title="Permalink to this headline">¶</a></h2>
<p>Django uses Python’s built-in logging module to perform system logging. In order to be configured, LOGGING is used to define a dictionary of logging setting. These settings describe the loggers, handlers, filters and formatters for logging setup and the log levels and other properties that the components should have and can be found under <code class="docutils literal notranslate"><span class="pre">django/tiip/setting.py</span></code> file. Fore more information, see the [official Django documentation)(https://docs.djangoproject.com/en/4.0/topics/logging/#topic-logging-parts-handlers).</p>
</div>
<div class="section" id="enable-debugging">
<h2>Enable debugging<a class="headerlink" href="#enable-debugging" title="Permalink to this headline">¶</a></h2>
<p>Debug mode is recommended to be set to True while developing locally and false when deploying a site into production. Debug mode is set and can be modified in <code class="docutils literal notranslate"><span class="pre">django/tiip/settings.py</span></code> file. One of the main features of debug mode is the display of detailed error pages. As a security measure, Django will not include settings that might be sensitive, such as SECRET_KEY. For more information, see the <a class="reference external" href="https://docs.djangoproject.com/en/4.0/ref/settings/">official Django documentation</a>.</p>
</div>
<div class="section" id="upgrade-db">
<h2>Upgrade DB<a class="headerlink" href="#upgrade-db" title="Permalink to this headline">¶</a></h2>
<p>Django uses Migrations as a way of propagating changes made on models into the database schema. For more information, see https://docs.djangoproject.com/en/4.0/topics/migrations/. The following commands should run on the local development environment in order to interact with migrations and Django’s handling of database schema.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose <span class="nb">exec</span> django python manage.py makemigrations
docker-compose <span class="nb">exec</span> django python manage.py migrate
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">UNICEF INVENT</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">ToC</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="purpose.html">Purpose</a></li>
<li class="toctree-l1"><a class="reference internal" href="scope.html">Scope</a></li>
<li class="toctree-l1"><a class="reference internal" href="target_audience.html">Target Audience</a></li>
<li class="toctree-l1"><a class="reference internal" href="abb_and_acronyms.html">Abbreviations and Acronyms</a></li>
<li class="toctree-l1"><a class="reference internal" href="scenarios.html">Scenarios</a></li>
<li class="toctree-l1"><a class="reference internal" href="core_diagrams.html">Core Diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="supplementary_diagrams.html">Supplementary Diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor_guide.html">Contributor’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation_manual.html">Installation Manual</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Administration Manual</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="installation_manual.html" title="previous chapter">Installation Manual</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, -.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="_sources/administration_manual.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>